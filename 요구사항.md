1. hashicorp vault 를 사용하고싶어. pod 로 생성해줘. dev mode 가 아니라 prod 모드로 생성해줘. 공식 문서를 첨부해줄테니깐 참고해. 스토리지는 raft 를 사용할래. 
2. vault agent pod 를 automation pod 에 sidecar 방식으로 띄워줘.
3. Vault Agent는 Vault로부터 "인증에 사용할 키"를 받는 것이 아니라, **자신이 실행되고 있는 Pod의 신원 정보(Identity)를 사용해 Vault에 스스로를 인증** 해야해.
4. `template`이나 `sink` 블록 대신, `listener` 블록을 사용합니다. `listener`는 Agent가 외부 요청을 받을 수 있는 네트워크 포트를 열라는 의미입니다.
5. ### 동작 방식 (프록시 모델)

```
 [ Pod A ]-------------------------------------------------------------------------+
 |                                                                                 |
 |  [ App Container ] <-----(3. 최종 비밀번호 수신)----- [ Vault Agent Sidecar ]    |
 |         │                                             (로컬 프록시 서버 역할)     |
 |         │                                                      │                |
 |         └-----(1. localhost로 API 요청)-------------------------┘                |
 |                                                                                 |
 +---------------------------------------------------------------------------------+
                                                               │
                                                               │ (2. 요청을 가로채 토큰을 붙여 Vault로 전달)
                                                               │
                                                               V
                                                         [ Vault 서버 ]
```

5-1.  **Vault Agent (비서)**
    *   자신의 신분증(K8s JWT)으로 Vault 서버에 로그인하여 유효한 **Vault 토큰을 발급받아 메모리에 혼자 간직**합니다.
    *   Pod 내부에서만 접근 가능한 로컬 프록시 서버(예: `localhost:8100`)를 실행합니다.

5-2.  **애플리케이션 (App)**
    *   애플리케이션 코드는 Vault 서버 주소(`http://vault.default.svc:8200`) 대신, 바로 옆에 있는 **비서의 주소(`http://localhost:8100`)**로 API 요청을 보냅니다.
    *   `X-Vault-Token` 같은 헤더를 전혀 신경 쓸 필요가 없습니다. 그냥 일반적인 HTTP 요청을 보냅니다.

5-3.  **마법이 일어나는 순간**
    *   Agent는 애플리케이션으로부터 온 로컬 요청을 가로챕니다.
    *   자신이 메모리에 보관하고 있던 유효한 Vault 토큰을 요청 헤더에 자동으로 추가합니다.
    *   이 요청을 실제 Vault 서버로 전달(프록시)합니다.
    *   Vault 서버로부터 받은 응답(최종 비밀번호가 담긴 JSON)을 그대로 다시 애플리케이션에게 전달합니다.
  
  
6. azure 환경에서 배포할건데, 수정할 부분이 있으면 수정해줘.
7. vault pod 는 clusterip 로 통신해야해.

  